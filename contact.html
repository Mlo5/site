<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="utf-8">
<title>اتصل بنا - M L O 5</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@600;800&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">

<!-- reCAPTCHA v3 -->
<script src="https://www.google.com/recaptcha/api.js?render=6LebACksAAAAAEyt-T68R7Kmg1nwI3IVcHPE3mVq
"></script>

<style>
:root{
  --bg:#020202;--yellow:#facc15;--white:#f9fafb;--muted:#9ca3af
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:Tajawal,sans-serif;background:var(--bg);color:var(--white);
  min-height:100vh;display:flex;justify-content:center;padding:16px
}
.page{width:100%;max-width:900px}
.btn{
  padding:9px 18px;border-radius:999px;border:2px solid #000;
  background:var(--yellow);font-weight:700;cursor:pointer
}
.btn.loading{pointer-events:none;opacity:.85}
.btn.loading::after{
  content:"";width:14px;height:14px;border:2px solid #000;border-top-color:transparent;
  border-radius:50%;display:inline-block;margin-inline-start:8px;
  animation:spin .7s linear infinite
}
@keyframes spin{to{transform:rotate(360deg)}}
.error-text{color:#f87171;font-size:.8rem}
.modal-overlay{
  position:fixed;inset:0;background:rgba(0,0,0,.75);
  display:none;align-items:center;justify-content:center;z-index:9999
}
.modal-overlay.show{display:flex}
.modal{
  background:#0b0b0b;border-radius:22px;padding:24px;text-align:center;
  border:1px solid rgba(250,204,21,.4)
}
.modal-icon{font-size:2rem}
.modal-title{font-weight:700;margin:6px 0}
.modal-text{color:var(--muted);font-size:.85rem;margin-bottom:14px}
.modal-btn{background:var(--yellow);border:none;border-radius:999px;padding:8px 22px;font-weight:700}
</style>
</head>

<body>
<main class="page">

<h2 id="title">اتصل بي</h2>

<form id="contact-form" action="https://formspree.io/f/xeoypvvj" method="POST">
<input type="hidden" name="_subject" id="hidden-subject">
<input type="hidden" name="g-recaptcha-response" id="recaptcha-token">
<input type="text" name="website" style="display:none">

<input id="name" name="name" placeholder="الاسم">
<div class="error-text" id="error-name"></div>

<input id="email" name="email" placeholder="البريد الإلكتروني">
<div class="error-text" id="error-email"></div>

<input id="subject" name="subject" placeholder="الموضوع">
<div class="error-text" id="error-subject"></div>

<textarea id="message" name="message" placeholder="رسالتك"></textarea>
<div class="error-text" id="error-message"></div>

<button class="btn" id="send-btn">إرسال</button>
</form>

</main>

<!-- Modal -->
<div class="modal-overlay" id="success-modal">
  <div class="modal">
    <div class="modal-icon">✅</div>
    <div class="modal-title" id="modal-title"></div>
    <div class="modal-text" id="modal-text"></div>
    <button class="modal-btn" id="modal-close">حسناً</button>
  </div>
</div>

<script>
const RECAPTCHA_SITE_KEY = "PUT_YOUR_SITE_KEY_HERE";
const RATE_LIMIT = 45;
const LAST_SEND_KEY = "mlo5-last-send";

const l10n={
 ar:{
  title:"اتصل بي",
  successTitle:"تم الإرسال بنجاح",
  successText:"شكراً لتواصلك، سيتم الرد عليك قريبًا",
  wait:s=>`انتظر ${s} ثانية قبل الإرسال`,
  send:"إرسال",
  sending:"جارٍ الإرسال..."
 },
 en:{
  title:"Contact Me",
  successTitle:"Message Sent",
  successText:"Thank you for contacting us",
  wait:s=>`Please wait ${s} seconds`,
  send:"Send",
  sending:"Sending..."
 }
};

let lang=localStorage.getItem("mlo5-lang")||"ar";
document.documentElement.dir=lang==="ar"?"rtl":"ltr";
document.getElementById("title").textContent=l10n[lang].title;

const form=document.getElementById("contact-form");
const btn=document.getElementById("send-btn");

function secondsLeft(){
 const t=localStorage.getItem(LAST_SEND_KEY);
 if(!t) return 0;
 return Math.ceil(RATE_LIMIT-(Date.now()-t)/1000);
}

form.addEventListener("submit",e=>{
 e.preventDefault();

 if(secondsLeft()>0){
   document.getElementById("error-message").textContent=l10n[lang].wait(secondsLeft());
   return;
 }

 grecaptcha.ready(()=>{
  grecaptcha.execute(RECAPTCHA_SITE_KEY,{action:"submit"}).then(token=>{
    document.getElementById("recaptcha-token").value=token;
    sendForm();
  });
 });
});

async function sendForm(){
 btn.classList.add("loading");
 btn.textContent=l10n[lang].sending;

 try{
  const res=await fetch(form.action,{method:"POST",body:new FormData(form),headers:{Accept:"application/json"}});
  if(res.ok){
    localStorage.setItem(LAST_SEND_KEY,Date.now());
    showModal();
    form.reset();
  }else{
    document.getElementById("error-message").textContent="Failed to send";
  }
 }catch{
  document.getElementById("error-message").textContent="Failed to send";
 }finally{
  btn.classList.remove("loading");
  btn.textContent=l10n[lang].send;
 }
}

const modal=document.getElementById("success-modal");
document.getElementById("modal-close").onclick=()=>modal.classList.remove("show");

function showModal(){
 document.getElementById("modal-title").textContent=l10n[lang].successTitle;
 document.getElementById("modal-text").textContent=l10n[lang].successText;
 modal.classList.add("show");
}
</script>
</body>
</html>
